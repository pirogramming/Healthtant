{% load static %}

<!DOCTYPE html>
<html lang="ko" data-colors-mode="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>{% block title %}HEALTHTANT{% endblock %}</title>

    <!-- 폰트 로드 - Inter로 통일 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Koulen&family=Satoshi:wght@400;500;700&display=swap"
      rel="stylesheet"
    />

    <!-- 기본 CSS 구조 -->
    <link rel="stylesheet" href="{% static 'base/variables.css' %}" />
    <link rel="stylesheet" href="{% static 'base/base.css' %}" />
    <link rel="stylesheet" href="{% static 'base/login_modal.css' %}" />
    
    <!-- 페이지별 CSS -->
    {% block extra_css %}{% endblock %}
  </head>
  <body>
    <div class="screen">
      <div class="view">
        <!-- 헤더 영역 -->
        {% block header %}
        <header class="app-header">
          <div class="status-bar"></div>
          
          <!-- 헤더 제목 영역 -->
          {% block header_title %}
          <h1 class="app-title">
            {% block app_title %}HEALTHTANT{% endblock %}
          </h1>
          {% endblock %}

          <!-- 헤더 추가 영역 -->
          {% block header_extra %}{% endblock %}

          <!-- 검색 영역 (기본 헤더에 포함) -->
          {% block header_search %}
          <section class="search-container">
            <form class="search-form" method="GET" action="#">
              <input
                type="text"
                class="search-input"
                name="q"
                placeholder="What's your daily needs?"
                aria-label="건강 제품 검색"
              />
              <button type="submit" class="search-button" aria-label="검색">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 20 20"
                  fill="none"
                >
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M9.18301 3.62746C6.11476 3.62746 3.62746 6.11476 3.62746 9.18301C3.62746 12.2513 6.11476 14.7386 9.18301 14.7386C10.6756 14.7386 12.0307 14.15 13.0289 13.1922C13.0525 13.1623 13.0782 13.1334 13.1058 13.1058C13.1334 13.0782 13.1623 13.0525 13.1922 13.0289C14.15 12.0307 14.7386 10.6756 14.7386 9.18301C14.7386 6.11476 12.2513 3.62746 9.18301 3.62746ZM15.146 13.7595C16.1202 12.492 16.6994 10.9052 16.6994 9.18301C16.6994 5.03185 13.3342 1.66667 9.18301 1.66667C5.03185 1.66667 1.66667 5.03185 1.66667 9.18301C1.66667 13.3342 5.03185 16.6994 9.18301 16.6994C10.9052 16.6994 12.492 16.1202 13.7595 15.146L16.6597 18.0462C17.0426 18.4291 17.6633 18.4291 18.0462 18.0462C18.4291 17.6633 18.4291 17.0426 18.0462 16.6597L15.146 13.7595Z"
                    fill="#56AAB2"
                  />
                </svg>
              </button>
            </form>
          </section>
          {% endblock %}
        </header>
        {% endblock %}

        <!-- 메인 콘텐츠 -->
        <main class="main-content">
          {% block content %}
          <!-- 페이지별 콘텐츠가 여기에 들어갑니다 -->
          {% endblock %}
        </main>
      </div>
    </div>

    <!-- 하단 네비게이션 - 선택적 표시 -->
    {% block bottom_navigation %}
    <nav class="main-nav">
      <ul class="nav-list">
        <li class="nav-item {% if request.resolver_match.url_name == 'diet_main' %}active{% endif %}">
          <a href="/diets/?year={% now 'Y' %}&month={% now 'n' %}" class="nav-link" aria-label="식단 기록">
            <div class="nav-icon-container">
              <svg xmlns="http://www.w3.org/2000/svg" width="15" height="20" viewBox="0 0 15 20" fill="none">
                <path d="M13.7891 1.25977H15V20H0V1.25977H1.23047V0H2.48047V1.25977H5V0H6.25V1.25977H8.76953V0H10.0195V1.25977H12.5391V0H13.7891V1.25977ZM13.75 18.75V2.50977H1.25V18.75H13.75ZM11.25 5.00977V6.25977H3.75V5.00977H11.25ZM3.75 16.2695V15.0195H11.25V16.2695H3.75ZM3.75 11.2598V10.0098H11.25V11.2598H3.75Z" fill="#B7B5B5"/>
              </svg>
            </div>
            <span class="nav-text">식단기록</span>
          </a>
        </li>
        
        <li class="nav-item {% if request.resolver_match.url_name == 'diet_analysis' %}active{% endif %}">
          <a href="/analysis/" class="nav-link" aria-label="분석하기">
            <div class="nav-icon-container">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M18 11.78L22.24 4.45L23.97 5.45L18.74 14.5L12.23 10.75L7.46 19H24V21H4V3H6V17.54L11.5 8L18 11.78Z" fill="#B7B5B5"/>
              </svg>
            </div>
            <span class="nav-text">분석하기</span>
          </a>
        </li>
        
        <li class="nav-item home-item active">
          <a href="" class="nav-link home-link" aria-label="홈">
            <div class="home-circle">
              <svg class="home-icon" xmlns="http://www.w3.org/2000/svg" width="27" height="28" viewBox="0 0 27 28" fill="none">
                <path d="M1.92556 25.8197H9.03472V16.7253C9.03472 16.3157 9.18427 15.9724 9.48338 15.6953C9.7812 15.4171 10.1503 15.2779 10.5906 15.2779H16.3672C16.8076 15.2779 17.1773 15.4171 17.4764 15.6953C17.7742 15.9724 17.9231 16.3157 17.9231 16.7253V25.8197H25.0323V10.2498C25.0323 10.0659 24.9893 9.89872 24.9032 9.74825C24.8172 9.59779 24.6998 9.46642 24.5509 9.35417L14.1837 2.08514C13.986 1.92512 13.7511 1.84511 13.4789 1.84511C13.2068 1.84511 12.9725 1.92512 12.7761 2.08514L2.40695 9.35417C2.25932 9.46881 2.14186 9.60017 2.05457 9.74825C1.96728 9.89633 1.92427 10.0635 1.92556 10.2498V25.8197ZM0 25.8197V10.2498C0 9.79124 0.110399 9.35716 0.331196 8.94755C0.551993 8.53794 0.856231 8.20058 1.24391 7.93547L11.613 0.630618C12.1561 0.244895 12.7761 0.0520325 13.4731 0.0520325C14.1702 0.0520325 14.7941 0.244895 15.3448 0.630618L25.7139 7.93368C26.1029 8.19879 26.4071 8.53675 26.6266 8.94755C26.8474 9.35716 26.9578 9.79124 26.9578 10.2498V25.8197C26.9578 26.2997 26.7659 26.7183 26.3821 27.0753C25.9982 27.4324 25.5483 27.6109 25.0323 27.6109H17.5534C17.1118 27.6109 16.7421 27.4724 16.4443 27.1954C16.1464 26.9171 15.9975 26.5732 15.9975 26.1636V17.071H10.9603V26.1636C10.9603 26.5744 10.8114 26.9183 10.5135 27.1954C10.2157 27.4724 9.84666 27.6109 9.40635 27.6109H1.92556C1.40951 27.6109 0.95957 27.4324 0.575742 27.0753C0.191914 26.7183 0 26.2997 0 25.8197Z" fill="#56AAB2"/>
              </svg>
            </div>
          </a>
        </li>
        
        <li class="nav-item {% if request.resolver_match.url_name == 'diet_search' %}active{% endif %}">
          <a href="#" class="nav-link" aria-label="상세검색">
            <div class="nav-icon-container">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="23" viewBox="0 0 24 23" fill="none">
                <path d="M11 18.2083C15.4183 18.2083 19 14.7759 19 10.5417C19 6.30748 15.4183 2.875 11 2.875C6.58172 2.875 3 6.30748 3 10.5417C3 14.7759 6.58172 18.2083 11 18.2083Z" stroke="#B7B5B5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M21 20.125L16.65 15.9562" stroke="#B7B5B5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <span class="nav-text">상세검색</span>
          </a>
        </li>
        
        <li class="nav-item {% if request.resolver_match.url_name == 'profile' %}active{% endif %}">
          <a href="{% url 'mypage:profile_view' %}" class="nav-link" aria-label="내 페이지">
            <div class="nav-icon-container">
              <svg xmlns="http://www.w3.org/2000/svg" width="21" height="23" viewBox="0 0 21 23" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M19.25 23C19.25 23 21 23 21 21.0833C21 19.1667 19.25 13.4167 10.5 13.4167C1.75 13.4167 0 19.1667 0 21.0833C0 23 1.75 23 1.75 23H19.25ZM1.7885 21.0833H19.2115C19.2197 21.0823 19.2279 21.081 19.236 21.0795L19.25 21.0757C19.2482 20.6042 18.9805 19.1858 17.794 17.8863C16.653 16.6367 14.5058 15.3333 10.5 15.3333C6.4925 15.3333 4.347 16.6367 3.206 17.8863C2.0195 19.1858 1.7535 20.6042 1.75 21.0757C1.76281 21.0784 1.77564 21.0809 1.7885 21.0833ZM10.5 9.58333C11.4283 9.58333 12.3185 9.17947 12.9749 8.46058C13.6313 7.74169 14 6.76666 14 5.75C14 4.73334 13.6313 3.75831 12.9749 3.03942C12.3185 2.32053 11.4283 1.91667 10.5 1.91667C9.57174 1.91667 8.6815 2.32053 8.02513 3.03942C7.36875 3.75831 7 4.73334 7 5.75C7 6.76666 7.36875 7.74169 8.02513 8.46058C8.6815 9.17947 9.57174 9.58333 10.5 9.58333ZM15.75 5.75C15.75 7.27499 15.1969 8.73753 14.2123 9.81586C13.2277 10.8942 11.8924 11.5 10.5 11.5C9.10761 11.5 7.77226 10.8942 6.78769 9.81586C5.80312 8.73753 5.25 7.27499 5.25 5.75C5.25 4.22501 5.80312 2.76247 6.78769 1.68414C7.77226 0.605802 9.10761 0 10.5 0C11.8924 0 13.2277 0.605802 14.2123 1.68414C15.1969 2.76247 15.75 4.22501 15.75 5.75Z" fill="#B7B5B5"/>
              </svg>
            </div>
            <span class="nav-text">내 페이지</span>
          </a>
        </li>
      </ul>
    </nav>
    {% endblock %}

    <!-- 페이지별 JavaScript -->
    {% block extra_js %}{% endblock %}

    <!-- 공통 로그인 모달 -->
    <div class="login-modal-overlay" id="loginModal" style="display: none;">
        <div class="login-modal-container">
            <div class="login-modal-content">
                <div class="login-modal-header">
                    <svg class="login-modal-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/>
                    </svg>
                    <h3 class="login-modal-title">잠깐! 로그인이 필요해요!</h3>
                </div>
                
                <div class="login-modal-message">
                    <p class="login-modal-text">나만의 정보를 확인하려면<br>지금 로그인해 주세요</p>
                </div>
                
                <div class="login-modal-buttons">
                    <button class="login-button" onclick="goToLogin()">로그인하기</button>
                    <button class="signup-button" onclick="goToSignup()">회원가입</button>
                </div>
                
                <div class="login-modal-features">
                    <svg class="login-modal-features-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                    <span class="login-modal-features-text">개인 맞춤 분석</span>
                </div>
                
                <div class="login-modal-description">
                    <p class="login-modal-description-text">로그인하시면 더 정확한 개인 및 분석 결과를 확인할 수 있어요</p>
                </div>
            </div>
        </div>
    </div>

    <script>
    // Django 템플릿에서 로그인 상태를 JavaScript로 전달
    window.isAuthenticated = {{ user.is_authenticated|yesno:"true,false" }};
    </script>
    <script type="module" defer src="{% static 'base/js/base.js' %}"></script>
  </body>
</html>

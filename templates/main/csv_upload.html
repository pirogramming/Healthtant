<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>데이터 업로드 - Healthtant</title>
</head>
<body>
    <h1>데이터 업로드</h1>
    
    <!-- 데이터베이스 통계 -->
    <div>
        <h2>데이터베이스 통계</h2>
        <div id="statsGrid">
            <div>총 식품 수: <span id="foodCount">-</span></div>
            <div>총 가격 정보: <span id="priceCount">-</span></div>
            <div>평균 가격: <span id="avgPrice">-</span></div>
            <div>식품 카테고리: <span id="categoryCount">-</span></div>
        </div>
        <button onclick="loadStats()">통계 새로고침</button>
    </div>

    <!-- 파일 업로드 -->
    <div>
        <h2>파일 업로드</h2>
        <form id="uploadForm">
            <div>
                <label for="tableType">테이블 타입:</label>
                <select id="tableType" name="tableType" required>
                    <option value="food">Food (식품 정보)</option>
                    <option value="price">Price (가격 정보)</option>
                </select>
            </div>

            <div>
                <label for="uploadMode">업로드 모드:</label>
                <select id="uploadMode" name="uploadMode" required>
                    <option value="upsert">Upsert (삽입 또는 업데이트)</option>
                    <option value="insert">Insert (새 데이터만 삽입)</option>
                    <option value="update">Update (기존 데이터만 업데이트)</option>
                </select>
            </div>

            <div>
                <label for="csvFile">파일 선택 (CSV 또는 XLSX):</label>
                <input type="file" id="csvFile" name="csvFile" accept=".csv,.xlsx" required>
                <div id="fileInfo"></div>
            </div>

            <button type="submit" id="uploadBtn">업로드 시작</button>
        </form>

        <div id="loading" style="display: none;">데이터를 처리하고 있습니다...</div>
        <div id="result"></div>
    </div>

    <!-- 템플릿 -->
    <div>
        <h2>템플릿</h2>
        <div>
            <h3>Food 테이블 템플릿</h3>
            <p>필수 컬럼: food_id, food_name, food_category, representative_food, nutritional_value_standard_amount, calorie, moisture, protein, fat, carbohydrate, weight, company_name</p>
            <button onclick="downloadTemplate('food')">Food 템플릿 다운로드</button>
        </div>

        <div>
            <h3>Price 테이블 템플릿</h3>
            <p>필수 컬럼: food_id, shop_name, price</p>
            <button onclick="downloadTemplate('price')">Price 템플릿 다운로드</button>
        </div>
    </div>

    {% block extra_js %}
    <script type="module" defer src="{% static 'main/js/main.js' %}"></script>
    {% endblock %}
</body>
</html> 
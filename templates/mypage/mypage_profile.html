{% extends 'base/base.html' %}
{% load static %}

{% block title %}마이페이지{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'mypage/mypage_profile.css' %}">
{% endblock %}

{% block header_title %}
<!-- 헤더 제목 영역을 비워서 기본 제목 숨기기 -->
{% endblock %}

{% block header_extra %}
<!-- 뒤로가기 버튼 추가 -->
<button class="back-button" onclick="window.location.href='{% url 'main:main_page' %}'">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M15 18L9 12L15 6" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
</button>
{% endblock %}

{% block content %}
<div class="content">
    <!-- 프로필 이미지 섹션 -->
    <div class="profile-picture-section">
        <div class="profile-picture-container">
            <div class="profile-picture">
                {% if user_data.profile_image_url %}
                    <img src="{{ user_data.profile_image_url }}" alt="프로필 이미지">
                {% else %}
                    <img src="{% static 'images/default.png' %}" alt="기본 프로필 이미지">
                {% endif %}
            </div>
        </div>
        <button class="edit-profile-button" onclick="goToProfilePage()">수정하기</button>
    </div>

    <!-- 사용자 정보 섹션 -->
    <div class="user-info-section">
        <div class="info-row">
            <span class="info-label">닉네임</span>
            <span class="info-value">@{{ user_data.nickname }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">나이</span>
            <span class="info-value">{{ user_data.user_age }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">성별</span>
            <span class="info-value">
                {% if user_data.user_gender == 'M' %}남자{% else %}여자{% endif %}
            </span>
        </div>
    </div>

    <!-- 즐겨찾는 제품 섹션 -->
    <div class="section">
        <div class="favorite-card" onclick="window.location.href='{% url 'mypage:favorite_food_list' %}'">
            <div class="favorite-content">
                <div class="favorite-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.04L12 21.35Z" fill="white"/>
                    </svg>
                </div>
                <div class="favorite-info">
                    <h3 class="favorite-title">즐겨찾는 제품</h3>
                    <p class="favorite-subtitle">나만의 건강한 식품들</p>
                </div>
            </div>
            <div class="favorite-arrow">
                <span class="arrow-text">보기</span>
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M7.5 15L12.5 10L7.5 5" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
        </div>
    </div>

    <!-- 로그아웃/탈퇴 섹션 -->
    <div class="section">
        <button class="section-title" onclick="confirmLogout()">로그아웃</button>
        <p class="withdrawal-text"
            onclick="window.location.href='{% url 'mypage:account_withdraw' %}'">
            탈퇴하기
        </p>
    </div> 
</div>
{% endblock %}

{% block bottom_navigation %}
{% endblock %}

{% block extra_js %}
<script>
    window.isAuthenticated = {{ user.is_authenticated|yesno:"true,false" }};
    window.serverImageUrl = '{{ user_data.profile_image_url }}';
</script>
<script src="{% static 'mypage/js/mypage.js' %}"></script>

{% endblock %}
